% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design_cloning_primers.R
\name{design_deletion_primers}
\alias{design_deletion_primers}
\title{Design Deletion Primers (Gibson Assembly, 4-Primer)}
\usage{
design_deletion_primers(
  vector_file,
  insert_seq = NULL,
  start,
  end,
  upstream_bp = 500,
  downstream_bp = 500,
  tm_target = 60,
  overlap_length = 16,
  min_target_length = 18,
  max_target_length = 50,
  max_primer_length = 70,
  max_iterations = 100,
  locus_tag = NULL,
  genome_seq = NULL,
  genbank_table = NULL,
  genbank_file = NULL,
  output_dir = NULL,
  kill_snapgene = TRUE
)
}
\arguments{
\item{vector_file}{Path to the vector file (.dna, .gb, .fasta).}

\item{insert_seq}{Character string. Combined arm sequence (upstream_arm + downstream_arm).
Not required if \code{locus_tag}, \code{genome_seq}, and \code{genbank_table} are provided.}

\item{start}{Integer. Vector insertion site start position (1-based, inclusive).}

\item{end}{Integer. Vector insertion site end position (1-based, inclusive).}

\item{upstream_bp}{Integer. Length of the upstream arm in bp (default: 500).}

\item{downstream_bp}{Integer. Length of the downstream arm in bp (default: 500).}

\item{tm_target}{Numeric. Target melting temperature for outer primers (default: 60).}

\item{overlap_length}{Integer. Initial vector overlap length in bp (default: 16).}

\item{min_target_length}{Integer. Minimum target binding region length (default: 18).}

\item{max_target_length}{Integer. Maximum target binding region length (default: 50).}

\item{max_primer_length}{Integer. Maximum total primer length (default: 70).}

\item{max_iterations}{Integer. Maximum optimization iterations (default: 100).}

\item{locus_tag}{Character. A single locus tag (e.g., \code{"QT234_RS00005"}) or
a range (\code{"TAG1-TAG2"}). When provided with \code{genome_seq} and
\code{genbank_table} (or \code{genbank_file}), arms are auto-extracted from the genome.}

\item{genome_seq}{Character string. Full genome sequence. Required for locus_tag mode
(unless \code{genbank_file} is provided).}

\item{genbank_table}{Data frame with columns: \code{locus_tag}, \code{start}, \code{end}.
Required for locus_tag mode (unless \code{genbank_file} is provided).
Optionally: \code{gene}, \code{product}.}

\item{genbank_file}{Character string. Path to a genome GenBank file (.gb, .gbk, .gbff).
When provided, \code{genome_seq} and \code{genbank_table} are automatically extracted
from this file using \code{read_genome_genbank()}. This overrides any separately
provided \code{genome_seq} and \code{genbank_table}.}

\item{output_dir}{Character. Directory to save output GenBank files. If provided,
a \code{{locus_tag}_deletion_vector.gbk} file is generated for SnapGene viewing.
Default: NULL (no GenBank output).}

\item{kill_snapgene}{Logical. Kill running SnapGene process before reading .dna
files to avoid file lock conflicts (default: FALSE).}
}
\value{
A named list with 4 primer sequences, Tm values (target and full),
primer positions in the modified vector, overlap Tm, and overlap length.
}
\description{
Designs 4 Gibson Assembly primers for gene deletion vector construction.
The upstream and downstream arms flanking the target gene are joined with
an optimized overlap, and outer primers include vector homology arms.
}
\details{
Two usage modes:
\enumerate{
\item \strong{Direct mode}: Provide \code{insert_seq} (pre-extracted upstream + downstream arm).
\item \strong{Locus tag mode}: Provide \code{locus_tag} + \code{genome_seq} + \code{genbank_table},
and the function auto-extracts arms from the genome (supports circular genomes).
}

This function faithfully ports the primer design logic from
\code{PrimerDesigner_for_Deletion.py}, including:
\itemize{
\item Outer primer Tm optimization (extend to 25bp, break if >60°C)
\item Vector overlap extension when overlap Tm < 55°C (up to 20bp)
\item Inner primer Tm optimization (55-65°C range, 60°C optimal, ±1°C tolerance)
\item Overlap region optimization (≥20bp combined, Tm ≥55°C, alternate extension by 2bp)
\item Max primer length 70bp constraint
\item Self-dimerization checking
}
}
\examples{
\dontrun{
# --- Mode 1: Single locus_tag with genome_seq + genbank_table ---
result <- design_deletion_primers(
  vector_file = "my_vector.dna",
  locus_tag = "QT234_RS00005",
  genome_seq = genome_sequence,
  genbank_table = genbank_df,
  start = 1234, end = 1256,
  upstream_bp = 500,
  downstream_bp = 500,
  output_dir = "deletion_results",
  kill_snapgene = TRUE
)

# --- Mode 1b: Single locus_tag with genbank_file (auto-extract) ---
result <- design_deletion_primers(
  vector_file = "my_vector.dna",
  locus_tag = "QT234_RS00005",
  genbank_file = "my_genome.gbk",
  start = 1234, end = 1256,
  output_dir = "deletion_results"
)

# --- Mode 2: Direct insert_seq ---
insert_seq <- paste0(upstream_arm, downstream_arm)
result <- design_deletion_primers(
  vector_file = "my_vector.dna",
  insert_seq = insert_seq,
  start = 1234, end = 1256,
  upstream_bp = 500,
  downstream_bp = 500
)

cat("Upstream F:", result$upstream_forward_primer, "\n")
cat("Upstream R:", result$upstream_reverse_primer, "\n")
cat("Downstream F:", result$downstream_forward_primer, "\n")
cat("Downstream R:", result$downstream_reverse_primer, "\n")
}
}
