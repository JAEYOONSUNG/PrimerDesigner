% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design_grna_and_deletion.R
\name{design_grna_and_deletion}
\alias{design_grna_and_deletion}
\title{Design gRNA + Deletion Arm Primers (Unified Pipeline)}
\usage{
design_grna_and_deletion(
  gRNA_df = NULL,
  genbank_file = NULL,
  genbank_accession = NULL,
  locus_tags,
  nuclease = "GeoCas9",
  top_n = 1,
  position_range = c(5, 95),
  tm_range = c(50, 70),
  strand = "both",
  methylation_patterns = NULL,
  dir = base::getwd(),
  grna_vector_file,
  grna_start,
  grna_end,
  grna_cloning_method = "gibson",
  grna_enzyme = "BbsI",
  grna_custom_overhangs = NULL,
  deletion_vector_file = NULL,
  deletion_start = NULL,
  deletion_end = NULL,
  upstream_bp = 500,
  downstream_bp = 500,
  tm_target = 60,
  overlap_length = 20,
  add_g = TRUE,
  grna_name_pattern = "sgRNA_{locus_tag}_{method}_{dir}",
  output_file = NULL,
  output_dir = NULL,
  kill_snapgene = TRUE,
  resume = FALSE
)
}
\arguments{
\item{gRNA_df}{Optional. Pre-generated gRNA library data frame.}

\item{genbank_file}{Character. Path to local genome GenBank file (.gbff, .gb).}

\item{genbank_accession}{Character. GenBank accession for auto-generation.}

\item{locus_tags}{Character vector. Target locus tag(s).}

\item{nuclease}{Character. Nuclease name (default: "GeoCas9").}

\item{top_n}{Integer. Number of best gRNAs to select (default: 1).}

\item{position_range}{Numeric vector. gRNA position range (default: c(5, 95)).}

\item{tm_range}{Numeric vector. gRNA Tm filter range (default: c(50, 70)).}

\item{strand}{Character. Strand filter (default: "both").}

\item{methylation_patterns}{Character vector. IUPAC methylation motifs.}

\item{dir}{Character. Working directory for auto-generation.}

\item{grna_vector_file}{Character. Path to gRNA expression vector.}

\item{grna_start}{Integer. gRNA stuffer start position (1-based).}

\item{grna_end}{Integer. gRNA stuffer end position (1-based).}

\item{grna_cloning_method}{Character. "gibson" or "golden_gate".}

\item{grna_enzyme}{Character. Golden Gate enzyme.}

\item{grna_custom_overhangs}{Named list. Custom overhangs.}

\item{deletion_vector_file}{Character or NULL. NULL = same as gRNA vector.}

\item{deletion_start}{Integer. Deletion arm stuffer start (1-based).
Required when using all-in-one vector. Must differ from grna_start.}

\item{deletion_end}{Integer. Deletion arm stuffer end (1-based).
Required when using all-in-one vector. Must differ from grna_end.}

\item{upstream_bp}{Integer. Upstream arm length (default: 500).}

\item{downstream_bp}{Integer. Downstream arm length (default: 500).}

\item{tm_target}{Numeric. Target Tm (default: 60).}

\item{overlap_length}{Integer. Gibson overlap length (default: 20).}

\item{add_g}{Logical. Add 5' G for transcription (default: TRUE).}

\item{grna_name_pattern}{Character. Primer naming pattern.}

\item{output_file}{Character or NULL. Excel output (.xlsx).}

\item{output_dir}{Character or NULL. GenBank output directory.}

\item{kill_snapgene}{Logical. Kill SnapGene before reading .dna.}

\item{resume}{Logical. If TRUE, skip Phase 1 by loading cached gRNA results
from \code{output_dir}, and skip locus tags whose GenBank files already exist.
Useful when a previous run was interrupted. (default: FALSE)}
}
\value{
A list with three components:
\describe{
\item{grna_primers}{Wide-format gRNA primer data (2 per gRNA).}
\item{deletion_primers}{Wide-format deletion arm primer data (4 per locus_tag).}
\item{unified_primers}{Long-format unified primer table (all primers):
locus_tag, type (sgRNA/homologous_arm), direction (F/R),
primer_name, sequence, Tm_target, Tm_full, length, ...}
}
}
\description{
All-in-one pipeline for CRISPR gene knockout primer design.
Combines gRNA expression construct primer design and deletion arm primer
design into a single function call.
}
\details{
For each target gene, this function:
\enumerate{
\item Generates and selects the best gRNA(s) (via \code{design_grna_construct})
\item Designs gRNA cloning primers (Gibson or Golden Gate, 2 per gRNA)
\item Designs deletion arm primers (4-primer Gibson for homologous recombination)
\item Produces a single combined GenBank showing the final construct
}
}
\section{Combined vs Separate mode}{

\describe{
\item{Combined (all-in-one vector)}{When \code{deletion_vector_file} is NULL
(same vector for both), \code{deletion_start/end} must be different from
\code{grna_start/end}. The gRNA spacer is inserted first, coordinates
are auto-adjusted, and deletion primers are designed against the
intermediate (gRNA-modified) vector. One combined GenBank per gRNA.}
\item{Separate vectors}{When \code{deletion_vector_file} is a different file,
each construct gets its own GenBank file.}
}
}

\examples{
\dontrun{
# All-in-one vector: two different stuffer sites
result <- design_grna_and_deletion(
  genbank_file = "~/genomes/GCF_030376765.1.gbff",
  locus_tags = "QT235_RS00005",
  nuclease = "GeoCas9",
  grna_vector_file = "~/vectors/pG1Kt-GeoCas9EF-OA-sfGFP-ACrec.dna",
  grna_start = 8811, grna_end = 8840,          # gRNA stuffer
  deletion_start = 5001, deletion_end = 5030,   # arm stuffer
  grna_cloning_method = "gibson",
  upstream_bp = 500, downstream_bp = 500,
  output_file = "all_primers.xlsx",
  output_dir  = "constructs/"
)
}
}
