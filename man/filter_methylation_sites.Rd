% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_methylation.R
\name{filter_methylation_sites}
\alias{filter_methylation_sites}
\title{Filter gRNAs by Methylation Site Conflicts}
\usage{
filter_methylation_sites(
  gRNA_df,
  methylation_patterns,
  nuclease = "GeoCas9",
  exclude = TRUE
)
}
\arguments{
\item{gRNA_df}{A data frame containing gRNA data. Must have
\code{protospacer} and \code{pam} columns.}

\item{methylation_patterns}{Character vector of methylation recognition
sequences using IUPAC ambiguity codes. Examples:
\code{c("GCCAT", "CCANNNNNTTG", "GATC")}.
IUPAC codes: N = any, R = A/G, Y = C/T, S = G/C, W = A/T,
K = G/T, M = A/C, B = C/G/T, D = A/G/T, H = A/C/T, V = A/C/G.}

\item{nuclease}{Character. Nuclease name to determine PAM side.
Supported: "GeoCas9", "SpCas9" (PAM 3' of spacer),
"FnCas12a", "FisCasI_B" (PAM 5' of spacer).
Default: "GeoCas9".}

\item{exclude}{Logical. If TRUE (default), remove gRNAs with
methylation conflicts. If FALSE, only add flag columns without
removing any rows.}
}
\value{
The input data frame with added columns:
\itemize{
\item \code{methylation_conflict}: Logical. TRUE if any motif was found.
\item \code{methylation_motifs}: Character. Comma-separated list of
matched motif(s) and their strand (e.g., "GCCAT(+), CCANNNNNTTG(-)").
}
If \code{exclude = TRUE}, rows with conflicts are removed.
}
\description{
Checks whether methylation recognition motifs overlap with the gRNA
target region (spacer + PAM context). gRNAs with methylation conflicts
are flagged and optionally removed.
}
\details{
Methyltransferases recognize specific DNA motifs and methylate bases
within them. If a methylation motif overlaps the PAM or spacer region,
the methylated base(s) may interfere with Cas nuclease binding or
cutting. This function identifies such conflicts.

Both strands are checked: the motif is searched on the sense strand
and its reverse complement is searched on the antisense strand.
}
\examples{
\dontrun{
# Geobacillus stearothermophilus methylation patterns
gRNA_filtered <- filter_methylation_sites(
  gRNA_df = gRNA_lib,
  methylation_patterns = c("GCCAT", "CCANNNNNTTG"),
  nuclease = "GeoCas9",
  exclude = TRUE
)

# Just flag without removing (for inspection)
gRNA_flagged <- filter_methylation_sites(
  gRNA_df = gRNA_lib,
  methylation_patterns = c("GCCAT", "CCANNNNNTTG"),
  nuclease = "GeoCas9",
  exclude = FALSE
)
table(gRNA_flagged$methylation_conflict)
}
}
