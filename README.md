PrimerDesigner for Gibson Assembly
----------------------------------

This Python script is designed to create Gibson Assembly primers and modify GenBank files by integrating target gene information extracted from an `xlsx` file generated by DNMB (DNA Manipulation and Molecular Biology). It leverages SnapGene software to convert `.dna` files into GenBank format and supports both single genes and multiple genes, either concatenated (e.g., `QT234_RS00005-00010`) or processed separately (e.g., `QT234_RS00005,QT234_RS00010`).

Key Features
------------

1. Extract Target Gene Data from `xlsx`:
   - Retrieves nucleotide sequences (`rearranged_nt_seq`), direction (`direction`), product descriptions (`product`), translated amino acid sequences (`translation`), and protein IDs (`protein_id`) from an `xlsx` file produced by DNMB.
   - Supports single genes (e.g., `QT234_RS00005`), concatenated genes with `-` (e.g., `QT234_RS00005-00010`), or multiple separate genes with `,` (e.g., `QT234_RS00005,QT234_RS00010`).

2. Gene Sequence Concatenation:
   - Concatenates sequences of multiple genes when provided as a combined `locus_tag` with `-` (e.g., `QT234_RS00005-00010`), adjusting for directionality.
   - Combines `/translation` fields into a single amino acid sequence with quotes for concatenated genes.

3. Gibson Assembly Primer Design:
   - Designs Gibson Assembly primers based on the specified vector and target sequences.
   - Calculates melting temperatures (Tm) to ensure primer suitability.

4. GenBank File Modification:
   - Converts SnapGene `.dna` files to GenBank format.
   - Inserts target genes into the vector sequence and adds primer information as `primer` features.
   - Preserves existing GenBank features without quotes, applying quotes only to the target gene’s `/translation`.

5. Log Generation:
   - Saves designed primers and Tm values in an `xlsx` log file, with a single file for all processed `locus_tag`s.

Usage
-----

Requirements
- Python Packages:
  - `pandas`
  - `biopython`
  - `snapgene_reader`
- SnapGene: Requires SnapGene CLI for converting `.dna` files to GenBank format.
- Operating System: macOS (SnapGene path set to `/Applications/SnapGene.app/Contents/MacOS/SnapGene`).

Installation
Install the required packages:
```bash
pip install pandas biopython snapgene_reader
```

Command-Line Execution Examples

1. Single Gene
For designing primers and generating a GenBank file for a single gene:
```bash
python script.py --genbank_table path/to/genbank_table.xlsx --locus_tag QT234_RS00005 --vector_file path/to/vector.dna --start 1000 --end 2000 --output_dir cloning_results
```
- Output: `QT234_RS00005_vector.gbk` and `log_QT234_RS00005.xlsx`.

2. Multiple Separate Genes (Comma-Separated)
For processing multiple genes independently in a loop:
```bash
python script.py --genbank_table path/to/genbank_table.xlsx --locus_tag QT234_RS00005,QT234_RS00010 --vector_file path/to/vector.dna --start 1000 --end 2000 --output_dir cloning_results
```
- Output: `QT234_RS00005_vector.gbk`, `QT234_RS00010_vector.gbk`, and `log_QT234_RS00005_QT234_RS00010.xlsx`.

3. Concatenated Operon (Hyphen-Connected)
For concatenating genes into a single operon-like target:
```bash
python script.py --genbank_table path/to/genbank_table.xlsx --locus_tag QT234_RS00005-00010 --vector_file path/to/vector.dna --start 1000 --end 2000 --output_dir cloning_results
```

Arguments
---------
--genbank_table: Path to the `xlsx` or `tsv` file from DNMB (required).
--locus_tag: Target gene identifier (single: `QT234_RS00005`, concatenated: `QT234_RS00005-00010`) (required).
--vector_file: Path to the SnapGene `.dna` vector file (required).
--start: Insertion start position in the vector (1-based, required).
--end: Insertion end position in the vector (1-based, required).
--output_dir: Output directory (default: `cloning_results`).
--tm: Target Tm for primers (default: 60°C).

Input Requirements
------------------

`xlsx` File Format
The `xlsx` file from DNMB must include the following columns:

Column Name        | Description                       | Example
-------------------|-----------------------------------|-----------------------
`locus_tag`        | Gene identifier                  | `QT234_RS00005`
`rearranged_nt_seq`| Nucleotide sequence              | `GTGGAA...`
`direction`        | Gene direction (`+` or `-`)      | `+`
`product`          | Gene product description         | `chromosomal replication initiator protein DnaA`
`translation`      | Translated amino acid sequence   | `MENIHDLWDRVL...`
`protein_id`       | Protein ID                       | `WP_289651751.1`

- For concatenated genes (e.g., `QT234_RS00005-00010`), each `locus_tag` must exist as a separate row in the `xlsx`.

Vector File
- A SnapGene `.dna` file is required.
- Insertion positions (`start`, `end`) must be valid within the vector sequence.
